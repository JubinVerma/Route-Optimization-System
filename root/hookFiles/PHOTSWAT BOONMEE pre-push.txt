#!/bin/sh
echo "Starting test runner..." 

cd "C:\Program Files\Microsoft Visual Studio\2022\Community\Common7\IDE\CommonExtensions\Microsoft\TestWindow"

failure_string="Failed:"

dll_path="C:\Users\User\Onedrive\Desktop\msSFT\root\SourceCode\MS_Project solution\x64\Debug\UnitTest2.dll"

echo "Running command: vstest.console.exe \"$dll_path\""
output=$(./vstest.console.exe "$dll_path")


echo "Command output:"
echo "$output"


if [[ "$output" == *"$failure_string"* ]]; then 
    echo >&2 "Unit tests are not passing! Push aborted!" 
    exit 1  # Fail the script to prevent push
else
    echo >&2 "All tests run successfully." 
    exit 0
fi